max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
View(m_example4)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example_spend_time <- m_example4$spand_time
View(m_example_spend_time)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
View(m_example_spend_time)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = xi_0, t = 10,
step_check = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
View(m_example_beta)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
simulation_xi <- m_example4$global_shrinkage_parameter
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
fixed_local_a3000 <- m_example4$local_shrinkage_parameter
rm(fixed_local_a3000)
# local shrinkage parameter
m_example_local <- m_example4$local_shrinkage_parameter
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.1, xi = 1, t = 10,
step_check = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- m_example4$local_shrinkage_parameter
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
log(.Machine$double.eps)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
min(m_example_local[, 1])
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 1, xi = 1, t = 10,
step_check = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 1000, p = 10000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.01, xi = xi_0, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
# xi_0
xi_0 <- ((1000 / 9000) / sqrt(1000))^(-2)
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
q <- ggplot(data = data.frame(X = 1:10000,
simulation_xi = simulation_xi[1:10000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# total_time
sum(m_example_spend_time$total_time)
