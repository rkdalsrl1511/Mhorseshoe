approx_horseshoe_result <- approx_horseshoe(X, y, iteration = 1000)
toc()
approx_horseshoe_result$BetaHat
approx_horseshoe_result$TauHat
approx_horseshoe_result$LambdaHat
approx_horseshoe_result$ActiveMean # 209
tic() # 75.75
approx_horseshoe_result2 <- approx_horseshoe(X, y, iteration = 1000,
auto.threshold = FALSE)
toc()
approx_horseshoe_result2$BetaHat
approx_horseshoe_result2$ActiveMean # 218
approx_horseshoe_result2$TauHat
approx_horseshoe_result2$LambdaHat
tic() # 151.3
horseshoe_result <- horseshoe(y, X, method.tau = "halfCauchy", method.sigma = "Jeffreys",
nmc = 1000)
toc()
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
install.packages("xaringan")
library(Mhorseshoe)
?approx_horseshoe
?approx_horseshoe
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
?rejection_sampler
remove.packages("Mhorseshoe")
library(Mhorseshoe)
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
?horseshoe::horseshoe
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
?exact_horseshoe
?approx_horseshoe
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
?Mhorseshoe
?approx_horseshoe
remove.packages("Mhorseshoe")
library(Mhorseshoe)
?approx_horseshoe
remove.packages("Mhorseshoe")
install.packages(c("devtools", "roxygen2", "testthat", "knitr"))
library(Mhorseshoe)
?approx_horseshoe
?mapprox_horseshoe
?approx_horseshoe
?mapprox_horseshoe
library(Mhorseshoe)
?approx_horseshoe
library(Mhorseshoe)
?approx_horseshoe
?exact_horseshoe
?Mhorseshoe
?approx_horseshoe
?Mhorseshoe
?approx_horseshoe
library(Mhorseshoe)
?approx_horseshoe
library(Mhorseshoe)
?approx_horseshoe
?exact_horseshoe
library(Mhorseshoe)
?approx_horseshoe
?approx_horseshoe
library(Mhorseshoe)
library(Mhorseshoe)
devtools::check_win_devel()
update.packages(checkBuilt=TRUE)
update.packages(checkBuilt = TRUE)
devtools::check_win_devel()
library(Mhorseshoe)
# Making simulation data.
set.seed(123)
N <- 50
p <- 100
true_beta <- c(rep(1, 10), rep(0, 90))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(p))
N <- 100
p <- 100
true_beta <- c(rep(1, 10), rep(0, 90))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(p))
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(2 * p))
N <- 100
p <- 200
true_beta <- c(rep(1, 10), rep(0, 190))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(2 * p))
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 500
p <- 1000
true_beta <- c(rep(1, 10), rep(0, 190))
true_beta <- c(rep(1, 10), rep(0, 990))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
result3$BetaHat
head(result3$BetaHat, 10)
head(result3$BetaHat, 15)
N <- 50
p <- 100
true_beta <- c(rep(1, 20), rep(0, 80))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 100
p <- 100
true_beta <- c(rep(1, 20), rep(0, 80))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 200
p <- 100
true_beta <- c(rep(1, 20), rep(0, 80))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 200
p <- 100
true_beta <- c(rep(1, 10), rep(0, 90))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 200
p <- 100
true_beta <- c(rep(1, 20), rep(0, 80))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
# Run with auto.threshold option
result1 <- approx_horseshoe(X, y, burn = 0, iter = 100)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
N <- 50
p <- 200
true_beta <- c(rep(1, 10), rep(0, 190))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
# Run with auto.threshold option
result1 <- approx_horseshoe(X, y, burn = 0, iter = 100)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
N <- 100
p <- 200
true_beta <- c(rep(1, 10), rep(0, 190))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
# Run with fixed custom threshold
for (i in 1:1000) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
}
# Run with fixed custom threshold
for (i in 1:1000) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
}
# Run with fixed custom threshold
for (i in 1:1000) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/p)
}
# Run with fixed custom threshold
for (i in 1:1000) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(5*p))
}
N <- 200
p <- 100
true_beta <- c(rep(1, 10), rep(0, 90))
X <- matrix(1, nrow = N, ncol = p) # Design matrix X.
for (i in 1:p) {
X[, i] <- stats::rnorm(N, mean = 0, sd = 1)
}
y <- vector(mode = "numeric", length = N) # Response variable y.
e <- rnorm(N, mean = 0, sd = 2) # error term e.
for (i in 1:10) {
y <- y + true_beta[i] * X[, i]
}
y <- y + e
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
#'
# Run with fixed default threshold
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
# Run with fixed custom threshold
for (i in 1:10) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(5*p))
}
# Run with fixed custom threshold
for (i in 1:10) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(5*p))
}
# Run with fixed custom threshold
for (i in 1:100) {
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(5*p))
}
# Run with fixed custom threshold
for (i in 1:100) {
result2 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE)
result3 <- approx_horseshoe(X, y, burn = 0, iter = 100,
auto.threshold = FALSE, threshold = 1/(5*p))
}
