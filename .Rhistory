for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:ncol(horseshoe_beta),
Y = horseshoe_beta[example_non_zero_index[i], 1001:ncol(horseshoe_beta)])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(horseshoe_beta[example_non_zero_index[i], 1001:ncol(horseshoe_beta)]),
max(horseshoe_beta[example_non_zero_index[i], 1001:ncol(horseshoe_beta)])))
ggsave(paste0("./1000실험기록/horseshoe_2/", "beta", example_non_zero_index[i], ".png"), q,
width = 40, height = 20, units = "cm")
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
horseshoe_beta_mean <- apply(t(horseshoe_beta[, 1001:5000]), MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - horseshoe_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - horseshoe_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
t(horseshoe_beta_mean[-example_non_zero_index]) %*% (horseshoe_beta_mean[-example_non_zero_index])
sum(example_spend_time$total_time)
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
# xi_0
xi_0 <- ((50 / 5000) / sqrt(500))^(-2)
# xi_0
xi_0 <- ((50 / 5000) / sqrt(500))^(-2)
# xi_0
xi_0 <- ((50 / 950) / sqrt(500))^(-2)
log(180500)
# xi_0
xi_0 <- ((50 / 4950) / sqrt(500))^(-2)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0, xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
m_example <- Mhorseshoe::fixed_modified(example_W, example_z, iteration = 5000,
xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spand_time
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1:nrow(example_beta),
Y = example_beta[1:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1:nrow(example_beta), example_non_zero_index[i]])))
ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q,
width = 40, height = 20, units = "cm")
#print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1:nrow(m_example_beta),
Y = m_example_beta[1:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1:nrow(m_example_beta), example_non_zero_index[i]])))
ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q,
width = 40, height = 20, units = "cm")
#print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1:nrow(example_beta),
Y = example_beta[1:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1:nrow(example_beta), example_non_zero_index[i]])))
ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
#print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
#print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
#print(q)
}
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
example_list
example_list <- readRDS(file = "./5000실험기록/repeat_a.rds")
example_list <- readRDS(file = "./5000실험기록/repeat_a.rds")
readRDS(file = "./5000실험기록/repeat_a.rds")
m_example_list <- readRDS(file = "./5000실험기록/repeat_m.rds")
example_list <- readRDS(file = "./5000실험기록/response_list.rds")
readRDS(file = "./5000실험기록/repeat_m.rds")
read_rds(file = "./5000실험기록/repeat_m.rds")
m_example_list <- readRDS(file = "./5000실험기록/repeat_a.rds")
m_example_list <- readRDS(file = "./5000실험기록/repeat_a.RDS")
m_example_list <- readRDS(file = "repeat_a.RDS")
m_example_list <- readRDS(file = "repeat_a.rds")
m_example_list <- readRDS(file = "repeat_m.rds")
example_list <- list()
m_example_list <- readRDS(file = "repeat_m.rds")
m_example_list <- readRDS(file = "./5000실험기록/repeat_m.rds")
saveRDS(example_list, file = "example_list.rds")
rm(example_list)
readRDS(file = "example_list.rds")
readRDS(file = "repeat_a.rds")
knitr::opts_chunk$set(echo = TRUE)
readRDS(file = "repeat_a.rds")
readRDS(file = "repeat_m.rds")
readRDS(file = "./5000실험기록/repeat_m.rds")
readRDS(file = "./5000실험기록/repeat_a.rds")
library(tidyverse)
library(invgamma)
library(MASS)
library(Rcpp)
library(horseshoe)
library(tictoc)
library(Mhorseshoe)
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
m_example_list <- readRDS(file = "./5000실험기록/repeat_m.rds")
m_example_list <- readRDS(file = "./5000실험기록/rapeat_a.rds")
m_example_list <- readRDS(file = "./5000실험기록/repeat_a.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
# xi_0
xi_0 <- ((50 / 4950) / sqrt(500))^(-2)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spand_time
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
m_example <- Mhorseshoe::fixed_modified(example_W, example_z, iteration = 5000,
xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^40,
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 1, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.01, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.01, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
example_response_list <- readRDS(file = "./1000실험기록/response_list.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
# xi_0
xi_0 <- ((50 / 950) / sqrt(500))^(-2)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, max_Epsilon = 10^(40),
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
horseshoe_1 <- horseshoe(example_z, example_W, method.tau = "halfCauchy",
method.sigma = "Jeffreys", burn = 0, nmc = 5000)
# horseshoe beta plot
horseshoe_beta <- horseshoe_1$BetaSamples
horseshoe_beta_mean <- apply(t(horseshoe_beta[, 1001:5000]), MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - horseshoe_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - horseshoe_beta_mean[example_non_zero_index]))
t(horseshoe_beta_mean[-example_non_zero_index]) %*% (horseshoe_beta_mean[-example_non_zero_index])
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 0.01, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
m_example <- Mhorseshoe::sampling_modified(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
