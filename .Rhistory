# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.01, xi = xi_0, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
# xi_0
xi_0 <- ((1000 / 9000) / sqrt(1000))^(-2)
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
q <- ggplot(data = data.frame(X = 1:10000,
simulation_xi = simulation_xi[1:10000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# total_time
sum(m_example_spend_time$total_time)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(invgamma)
library(MASS)
library(Rcpp)
library(horseshoe)
library(tictoc)
library(Mhorseshoe)
library(tidyverse)
library(invgamma)
library(MASS)
library(Rcpp)
library(horseshoe)
library(tictoc)
library(Mhorseshoe)
rexp(10, rate = 5)
mean(rexp(100, rate = 5))
mean(rexp(1000, rate = 5))
mean(rexp(10000, rate = 5))
mean(rexp(10000, rate = 1/5))
mean(rexp(10000, rate = 10000))
mean(- log(1-runif(10000)) / 5)
mean(- log(1-runif(10000)) / 5)
mean(- log(1-runif(100000)) / 5)
mean(rexp(n = 10000, rate = 1/5))
mean(rexp(n = 10000, rate = 5))
rep(1, 10)
(1:p)[-c(1,2,3)]
(1:10)[-c(1,2,3)]
(1:10)[-c(1,4,10)]
1:10[-c(1,4,10)]
(1:10)[-c(1,4,10)]
which(c(1,2,3,4,5,6,2,4) > 1)
which(c(1,2,3,4,5,6,2,4) > 5)
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(m_example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
example4 <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1, max_Epsilon = 10^(40),
step_check = TRUE)
example4 <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1,
step_check = TRUE)
library(Mhorseshoe)
example4 <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 1, xi = 1,
step_check = TRUE)
knitr::opts_chunk$set(echo = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
# example beta trace plot
example_beta <- example4$beta
example_spend_time <- example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# local shrinkage parameter
m_example_local <- log(example4$local_shrinkage_parameter)
# local shrinkage parameter
m_example_local <- log(example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 1000, p = 10000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
m_example4 <- Mhorseshoe::sampling_modified_edit(example_W, example_z, iteration = 5000,
s = 1, xi = 1, t = 10,
step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example4$beta
m_example_spend_time <- m_example4$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example4$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
apply(m_example_local[, 1:23], MARGIN = 1, mean)
apply(m_example_local[, 1:23], MARGIN = 2, mean)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# xi_0
xi_0 <- ((100 / 9900) / sqrt(1000))^(-2)
# xi_0
xi_0 <- ((50 / 4950) / sqrt(500))^(-2)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_algorithm(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
library(tidyverse)
library(invgamma)
library(MASS)
library(Rcpp)
library(horseshoe)
library(tictoc)
library(Mhorseshoe)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample_fix/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
simulation_xi <- log(m_example$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# local shrinkage parameter
m_example_local <- log(example4$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
# local shrinkage parameter
m_example_local <- log(m_example$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = xi_0, step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
View(m_example_spend_time)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.1, xi = xi_0, step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
View(m_example_spend_time)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
sum(m_example_spend_time$total_time)
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.01, xi = xi_0, step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.001, xi = xi_0, step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/s비교용/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:5000, ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
# total_time
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
