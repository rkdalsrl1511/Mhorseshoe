q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(example_sigma)
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
m_example_sigma <- m_example$sigma2
ggplot(data = data.frame(X = 1:length(m_example_sigma),
Y = m_example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(m_example_sigma)
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 300, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(example_sigma)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 10000,
s = 0.8, xi = 1, step_check = TRUE)
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(example_sigma)
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 300, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 10000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(m_example_sigma)
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(example_sigma)
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 500, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 10000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
mean(example_sigma)
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 100, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
example_sigma <- example$sigma_parameter
ggplot(data = data.frame(X = 1:length(example_sigma),
Y = example_sigma)) +
geom_line(mapping = aes(x = X, y = Y))
horseshoe_1 <- horseshoe(example_z, example_W, method.tau = "halfCauchy",
method.sigma = "Jeffreys", burn = 0, nmc = 5000)
mean(horseshoe_1$Sigma2Samples)
ggplot(data = data.frame(X = 1:length(horseshoe_1$Sigma2Samples),
Y = horseshoe_1$Sigma2Samples)) +
geom_line(mapping = aes(x = X, y = Y))
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 500, p = 1000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
example_beta_mean <- apply(example_beta[1001:nrow(example_beta), ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# local shrinkage parameter
m_example_local <- log(example$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
apply(m_example_local[, 1:23], MARGIN = 2, mean)
log(.Machine$double.eps)
mean(m_example_sigma)
apply(m_example_local[, 1:23], MARGIN = 2, mean)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
library(Mhorseshoe)
knitr::opts_chunk$set(echo = TRUE)
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# local shrinkage parameter
m_example_local <- log(example$local_shrinkage_parameter)
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_local),
local = m_example_local[1001:nrow(m_example_local),
example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = local))
print(q)
}
simulation_xi <- log(example$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
example_beta_mean <- apply(example_beta[1001:nrow(example_beta), ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
example_response_list <- readRDS(file = "./5000실험기록/response_list.rds")
# N = 500, p = 5000, 존드로우 실험용
example_response_list <- make_simulation_data(N = 1000, p = 5000, Johndraw = TRUE)
example_W <- example_response_list[[1]]
example_z <- example_response_list[[2]]
example_non_zero_index <- example_response_list[[3]]
example_non_zero_coefficents <- example_response_list[[4]]
# SNR
var(example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (t(example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) %*% (example_z - example_W[, example_non_zero_index] %*% example_non_zero_coefficents) / (499))
example <- Mhorseshoe::approximate_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
# example beta trace plot
example_beta <- example$beta
example_spend_time <- example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# m_example beta trace plot
m_example_beta <- m_example$beta
m_example_spend_time <- m_example$spend_time
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(example_beta),
Y = example_beta[1001:nrow(example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(example_beta[1001:nrow(example_beta), example_non_zero_index[i]]),
max(example_beta[1001:nrow(example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/a_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
for (i in 1:length(example_non_zero_index)) {
q <- ggplot(data = data.frame(X = 1001:nrow(m_example_beta),
Y = m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])) +
geom_line(mapping = aes(x = X, y = Y)) +
labs(x = str_c("beta ", example_non_zero_index[i]), y = "value",
title = str_c("true value = ", example_non_zero_coefficents[i])) +
coord_cartesian(ylim = c(min(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]]),
max(m_example_beta[1001:nrow(m_example_beta), example_non_zero_index[i]])))
#ggsave(paste0("./5000실험기록/m_sample1/", "beta", example_non_zero_index[i], ".png"), q)
print(q)
}
# total_time
# 596, 720
sum(m_example_spend_time$total_time)
sum(example_spend_time$total_time)
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
simulation_xi <- log(m_example$global_shrinkage_parameter)
q <- ggplot(data = data.frame(X = 1:5000,
simulation_xi = simulation_xi[1:5000])) +
geom_line(mapping = aes(x = X, y = simulation_xi)) +
labs(title = "case 3 xi graph")
print(q)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:nrow(m_example_beta), ], MARGIN = 2, mean)
# L2 non-zero
m_example_beta_mean <- apply(m_example_beta[1001:nrow(m_example_beta), ], MARGIN = 2, mean)
example_beta_mean <- apply(example_beta[1001:nrow(example_beta), ], MARGIN = 2, mean)
sqrt(t(example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - m_example_beta_mean[example_non_zero_index]))
sqrt(t(example_non_zero_coefficents - example_beta_mean[example_non_zero_index]) %*% (example_non_zero_coefficents - example_beta_mean[example_non_zero_index]))
# L2 zero
t(m_example_beta_mean[-example_non_zero_index]) %*% (m_example_beta_mean[-example_non_zero_index])
t(example_beta_mean[-example_non_zero_index]) %*% (example_beta_mean[-example_non_zero_index])
ggplot(data = data.frame(X = 101:nrow(example_spend_time),
approximate_active_set = example_spend_time$total_active_column[101:nrow(example_spend_time)],
modified_active_set = m_example_spend_time$`number of active set columns`[101:nrow(m_example_spend_time)])) +
geom_line(mapping = aes(x = X, y = approximate_active_set, color = "red")) +
geom_line(mapping = aes(x = X, y = modified_active_set, color = "blue")) +
scale_color_manual(values = c("red", "blue"), breaks = c("red", "blue"),
labels = c("approximate_active_set", "modified_active_set")) +
labs(x = "iteration", y = "number of active set")
m_example <- Mhorseshoe::modified_horseshoe(example_W, example_z, iteration = 5000,
s = 0.8, xi = 1, step_check = TRUE)
